

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>
	注册会员页面
</title>
        <script src="../js/checkform.js" type="text/javascript"></script>  
    <script src="../js/jquery-latest.pack.js" type="text/javascript"></script>
    <script src="../js/jquery-1.2.4b.js" type="text/javascript"></script>  
    <link href="../css/validator.css" rel="stylesheet" type="text/css" />
    <script src="../js/formValidator_min.js" type="text/javascript"></script>
    <script src="../js/formValidatorRegex.js" type="text/javascript"></script>
    
    <script language="javascript" type="text/javascript" src="../My97DatePicker/WdatePicker.js">
       </script>
       
       <script type="text/javascript">
           $(document).ready(function() {
               var arrMust = new Array();
               var strMust = '0*0*0*0*0*0*0*0*0*0*0*0*0*0*0*0*0';
               arrMust = strMust.split('*');
               $.formValidator.initConfig({ onError: function(msg) { alert(msg) } });
               $("#txt_memberID").formValidator({ onshow: "请输入用户名", onfocus: "用户名为5~15个字母、数字、横线或下划线", oncorrect: "用户名合法" }).InputValidator({ min: 1, onerror: "用户名不能为空,请确认" }).RegexValidator({ regexp: "^[a-zA-Z0-9_-]{5,15}$", onerror: "您输入的用户名不正确" });
               $("#txt_mPassword").formValidator({ onshow: "请输入密码", onfocus: "密码为5~15个字符字母、数字或下划线", oncorrect: "密码合法" }).InputValidator({ min: 1, onerror: "密码不能为空,请确认" }).RegexValidator({ regexp: "^[a-zA-Z0-9_]{5,15}$", onerror: "您输入的密码不正确" }); ;
               $("#txt_mPwdConfirm").formValidator({ onshow: "请输入重复密码", onfocus: "两次密码必须一致哦", oncorrect: "密码一致" }).InputValidator({ min: 1, onerror: "重复密码不能为空,请确认" }).CompareValidator({ desID: "txt_mPassword", operateor: "=", onerror: "2次密码不一致,请确认" });
               if (arrMust[0] == '1') {
                   $("#txt_mName").formValidator({ onshow: "请输入真实姓名（*）", onfocus: "姓名为10个字符内的汉字", oncorrect: "姓名合法" }).InputValidator({ min: 1, max: 10, onerror: "姓名长度不正确,请确认" }).RegexValidator({ regexp: "[\u4e00-\u9fa5]", onerror: "您输入的姓名不正确" });
               }
               else {
                   $("#txt_mName").formValidator({ empty: true, onshow: "请输入真实姓名", onfocus: "姓名为10个字符内的汉字", oncorrect: "姓名合法", onempty: "您真的不想留下姓名吗？" }).InputValidator({ min: 1, max: 10, onerror: "姓名长度不正确,请确认" }).RegexValidator({ regexp: "[\u4e00-\u9fa5]", onerror: "您输入的姓名不正确" });
               }
               if (arrMust[1] == '1') {
                   $("#ddl_mSex").formValidator({ onshow: "请选择您的性别（*）", onfocus: "请选择", oncorrect: "性别已选择" }).InputValidator({ min: 1, max: 30, onerror: "所在地区不能为空！" });
               }
               else {
                   $("#ddl_mSex").formValidator({ empty: true, onshow: "请选择您的性别", onfocus: "请选择", oncorrect: "性别已选择", onempty: "您真的不选择性别吗？" }).InputValidator({ min: 1, max: 30, onerror: "所在地区不能为空！" });
               }
               if (arrMust[2] == '1') {
                   $("#txt_mQuestion").formValidator({ onshow: "请输入您的提示问题，以便找回密码（*）", onfocus: "至少6个字符,最多30个字符", oncorrect: "谢谢您的合作" }).InputValidator({ min: 6, max: 30, onerror: "您输入的提示问题字符长度不正确,请确认！" });
               }
               else {
                   $("#txt_mQuestion").formValidator({ empty: true, onshow: "请输入您的提示问题，以便找回密码", onfocus: "至少6个字符,最多30个字符", oncorrect: "谢谢您的合作", onempty: "您真的不想设置提示问题了吗？" }).InputValidator({ min: 6, max: 30, onerror: "您输入的提示问题字符长度不正确,请确认！" });
               }
               if (arrMust[3] == '1') {
                   $("#txt_mAnswer").formValidator({ onshow: "请输入您的回答问题，以便找回密码（*）", onfocus: "至少6个字符,最多30个字符", oncorrect: "谢谢您的合作" }).InputValidator({ min: 6, max: 30, onerror: "您输入的回答问题字符长度不正确,请确认！" });
               }
               else {
                   $("#txt_mAnswer").formValidator({ empty: true, onshow: "请输入您的回答问题，以便找回密码", onfocus: "至少6个字符,最多30个字符", oncorrect: "谢谢您的合作", onempty: "您真的不想设置回答问题了吗？" }).InputValidator({ min: 6, max: 30, onerror: "您输入的回答问题字符长度不正确,请确认！" });
               }
               if (arrMust[4] == '1') {
                   $("#txt_mShopAddress").formValidator({ onshow: "请输入您的店铺地址（*）", onfocus: "至少6个字符,最多100个字符", oncorrect: "谢谢您的合作" }).InputValidator({ min: 6, max: 100, onerror: "您输入的店铺地址字符长度不正确,请确认！" });
               }
               else {
                   $("#txt_mShopAddress").formValidator({ empty: true, onshow: "请输入您的店铺地址", onfocus: "至少6个字符,最多100个字符", oncorrect: "谢谢您的合作", onempty: "您真的不想设置店铺地址了吗？" }).InputValidator({ min: 6, max: 100, onerror: "您输入的店铺地址字符长度不正确,请确认！" });
               }
               if (arrMust[5] == '1') {
                   $("#txt_mIDcard").formValidator({ onshow: "请输入您的身份证号码（*）", onfocus: "15位或18位数字", oncorrect: "谢谢您的合作" }).InputValidator({ min: 15, max: 18, onerror: "您输入的身份证字符长度不正确,请确认！" }).RegexValidator({ regexp: "^[1-9]([0-9]{14}|[0-9]{17})$", onerror: "您输入的身份证号码不正确" });
               }
               else {
                   $("#txt_mIDcard").formValidator({ empty: true, onshow: "请输入您的身份证号码", onfocus: "15位或18位数字", oncorrect: "谢谢您的合作", onempty: "您真的不想设置身份证了吗？" }).InputValidator({ min: 15, max: 18, onerror: "您输入的身份证字符长度不正确,请确认！" }).RegexValidator({ regexp: "^[1-9]([0-9]{14}|[0-9]{17})$", onerror: "您输入的身份证号码不正确" });
               }
               if (arrMust[6] == '1') {
                   $("#txt_mBirthDate").formValidator({ onshow: "请选择您的出生日期（*）", onfocus: "请选择您的出生日期", oncorrect: "谢谢您的合作" }).InputValidator({ min: 1, max: 30, onerror: "出生日期不能为空！" });
               }
               else {
                   $("#txt_mBirthDate").formValidator({ empty: true, onshow: "请选择您的出生日期", onfocus: "请选择您的出生日期", oncorrect: "谢谢您的合作", onempty: "您真的不想设置您的出生日期了吗？" }).InputValidator({ min: 1, max: 30, onerror: "出生日期格式不正确！" });
               }
               if (arrMust[7] == '1') {
                   $("#ddl_province").formValidator({ onshow: "请选择您所在地区（*）", onfocus: "请依次选择", oncorrect: "谢谢您的合作" }).InputValidator({ min: 1, max: 30, onerror: "所在地区不能为空！" });
               }
               else {
                   $("#ddl_province").formValidator({ empty: true, onshow: "请选择您所在地区", onfocus: "请依次选择", oncorrect: "谢谢您的合作", onempty: "您真的不想设置您的所在地区了吗？" }).InputValidator({ min: 1, max: 30, onerror: "所在地区格式不正确！" });
               }
               if (arrMust[8] == '1') {
                   $("#txt_mQQMsn").formValidator({ onshow: "请输入QQ或MSN号码（*）", onfocus: "请仔细输入！", oncorrect: "谢谢您的合作" }).InputValidator({ min: 1, max: 30, onerror: "您输入的QQ/MSN字符长度不正确,请确认" }).RegexValidator({ regexp: "^[1-9][0-9]{4,}$", onerror: "您输入的QQ或MSN格式不正确" });
               }
               else {
                   $("#txt_mQQMsn").formValidator({ empty: true, onshow: "请输入QQ或MSN号码", onfocus: "您要是输入了，请仔细输入", oncorrect: "谢谢您的合作", onempty: "您真的不想留QQ或MSN了吗？" }).InputValidator({ min: 1, max: 30, onerror: "你输入的QQ/MSN字符长度非法,请确认" }).RegexValidator({ regexp: "^([1-9][0-9]{4,})|(([\\w-.]+)@(([[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.)|(([\\w-]+.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(]?))$", onerror: "您输入的QQ或MSN格式不正确" });
               }
               if (arrMust[9] == '1') {
                   $("#txt_mTelephone").formValidator({ onshow: "请输入您的手机号码（*）", onfocus: "请仔细输入", oncorrect: "谢谢您的合作" }).InputValidator({ min: 11, max: 11, onerror: "手机号码必须是11位的,请确认" }).RegexValidator({ regexp: "mobile", datatype: "enum", onerror: "您输入的手机号码格式不正确" }); ;
               }
               else {
                   $("#txt_mTelephone").formValidator({ empty: true, onshow: "请输入您的手机号码", onfocus: "您要是输入了，请仔细输入", oncorrect: "谢谢您的合作", onempty: "您真的不想留手机号码啊？" }).InputValidator({ min: 11, max: 11, onerror: "手机号码必须是11位的,请确认" }).RegexValidator({ regexp: "mobile", datatype: "enum", onerror: "您输入的手机号码格式不正确" }); ;
               }
               if (arrMust[10] == '1') {
                   $("#txt_mPhone").formValidator({ onshow: "请输入您的联系电话（*）", onfocus: "格式例如：010-12345678", oncorrect: "谢谢您的合作" }).RegexValidator({ regexp: "^[[0-9]{3}-|\[0-9]{4}-]?([0-9]{8}|[0-9]{7})?$", onerror: "您输入的联系电话格式不正确" });
               }
               else {
                   $("#txt_mPhone").formValidator({ empty: true, onshow: "请输入您的联系电话", onfocus: "格式例如：010-12345678", oncorrect: "谢谢您的合作", onempty: "您真的不想留联系电话了吗？" }).RegexValidator({ regexp: "^[[0-9]{3}-|\[0-9]{4}-]?([0-9]{8}|[0-9]{7})?$", onerror: "您输入的联系电话格式不正确" });
               }
               if (arrMust[11] == '1') {
                   $("#txt_mEmail").formValidator({ onshow: "请输入您的电子邮箱（*）", onfocus: "请仔细输入", oncorrect: "谢谢您的合作" }).InputValidator({ min: 1, max: 50, onerror: "您输入的电子邮箱长度不正确,请确认！" }).RegexValidator({ regexp: "^([\\w-.]+)@(([[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.)|(([\\w-]+.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(]?)$", onerror: "您输入的邮箱格式不正确" });
               }
               else {
                   $("#txt_mEmail").formValidator({ empty: true, onshow: "请输入邮箱", onfocus: "您要是输入了，请仔细输入", oncorrect: "谢谢您的合作", onempty: "您真的不想设置联系邮箱了吗？" }).InputValidator({ min: 1, max: 100, onerror: "您输入的邮箱长度非法,请确认！" }).RegexValidator({ regexp: "^([\\w-.]+)@(([[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.)|(([\\w-]+.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(]?)$", onerror: "您输入的邮箱格式不正确" });
               }
               if (arrMust[12] == '1') {
                   $("#txt_mConnectAddress").formValidator({ onshow: "请输入您的详细地址（*）", onfocus: "详细地址至少6个字符,最多200个字符", oncorrect: "谢谢您的合作" }).InputValidator({ min: 6, max: 200, onerror: "您输入的详细地址长度不正确,请确认！" });
               }
               else {
                   $("#txt_mConnectAddress").formValidator({ empty: true, onshow: "请输入您的详细地址", onfocus: "详细地址至少6个字符,最多200个字符", oncorrect: "谢谢您的合作", onempty: "您真的不想设置联系地址了吗？" }).InputValidator({ min: 6, max: 200, onerror: "您输入的详细地址长度不正确,请确认！" });
               }
               if (arrMust[13] == '1') {
                   $("#txt_mPostCode").formValidator({ onshow: "请输入邮编（*）", onfocus: "格式例如：621000！", oncorrect: "谢谢您的合作" }).InputValidator({ min: 6, max: 6, onerror: "您输入的邮编格式不正确,请确认！" }).RegexValidator({ regexp: "^\\d{6}$", onerror: "您输入的邮编格式不正确" });
               }
               else {
                   $("#txt_mPostCode").formValidator({ empty: true, onshow: "请输入邮编", onfocus: "格式例如：621000！", oncorrect: "谢谢您的合作", onempty: "您真的不想设置邮编了吗？" }).InputValidator({ min: 6, max: 6, onerror: "您输入的邮编格式不正确,请确认！" }).RegexValidator({ regexp: "^\\d{6}$", onerror: "您输入的邮编格式不正确" });
               }
               if (arrMust[14] == '1') {
                   $("#txt_mRemark").formValidator({ onshow: "请输入您的备注信息（*）", onfocus: "随便写写~！", oncorrect: "谢谢您的合作" }).InputValidator({ min: 1, max: 1000, onerror: "您输入的备注信息字符长度不正确,请确认！" });
               }
               else {
                   $("#txt_mRemark").formValidator({ empty: true, onshow: "请输入您的备注信息", onfocus: "随便写写~！", oncorrect: "谢谢您的合作", onempty: "您真的不想设置备注信息了吗？" }).InputValidator({ min: 1, max: 1000, onerror: "您输入的备注信息字符长度不正确,请确认！" });
               }
               if (arrMust[15] == '1') {
                   $("#ddl_mVouchID").formValidator({ onshow: "请选择您的推荐人（*）", onfocus: "请认真选择", oncorrect: "谢谢您的合作" }).InputValidator({ min: 1, max: 30, onerror: "推荐人不能为空！" });
               }
               else {
                   $("#ddl_mVouchID").formValidator({ empty: true, onshow: "请选择您的推荐人", onfocus: "请认真选择", oncorrect: "谢谢您的合作", onempty: "您真的不想选择您的推荐人吗？" }).InputValidator({ min: 1, max: 30, onerror: "推荐人输入不正确！" });
               }
           });
           function retcheck(evt) {
                   if (jQuery.formValidator.PageIsValid('1')) {
                       return checkForm(evt);
                   }
                   else {
                       return false;
                   }
           }
           function tip(mess) {

               alert(mess);
               history.back();

           }

           function checkUserExists(a) {
               var memberID = a;
               $.ajax({
                   url: '../webService.asmx/checkUserExists',
                   type: 'POST',
                   dataType: 'json',
                   contentType: 'application/json',
                   data: "{memberID:'" + memberID + "'}",

                   success: function(data) {
                       var json = eval("(" + data.d + ")");
                       if (json.success == true) {
                           var msg = json.msg;
                           if (msg != 'true') {
                               alert('注意：该会员已存在！');
                               return;
                           }
                       }
                   },
                   error: function(r) {

                   }
               })
         }
       </script>
       
       <style type="text/css">
       #body
       {
     	width:100%;
	height:100%;
	margin-top:0px;
    margin-right:auto;
    margin-bottom:0px;
    margin-left:auto;
       }
       #form1
       {
       	width:700px;
	height:100%;
	margin-top:0px;
    margin-right:auto;
    margin-bottom:0px;
    margin-left:auto;
       }
       
        .style1
        {
        	font-size:13px;
            width: 80px;
            text-align:right;
            color:#333333;
        }
        .style2
        {
        	font-size:13px;
            width: 254px;
            text-align: left;
        }
        .divClass
        {
        	font-size:13px;
        	width:200px;     
        }
 
   .barIndicator_weak
    {
        color: Red;
        background-color: Red;  
    }
    .barIndicator_average
    {
        color: Blue;
        background-color: Blue; 
    }
    .barIndicator_good
    {
        color: Green;
        background-color: Green;
    }

    .barBorder
    {
        border:double #808080;
        width: 249px;
        margin-top: 0px;
    }
       </style>
</head>
<body>
     <form name="form1" method="post" action="register.aspx" id="form1" style="text-align:center" enctype="multipart/form-data" onsubmit="javascript:return retcheck(this)">
<input type="hidden" name="ScriptManager1_HiddenField" id="ScriptManager1_HiddenField" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJODIwNzAwMDE2D2QWAgIDD2QWAgIDD2QWAmYPZBYCAgEPZBYiAgkPFgIeB1Zpc2libGVoZAILDxYCHwBoFgICAQ9kFgICAQ8QZGQWAWZkAg0PFgIfAGhkAg8PFgIfAGhkAhEPFgIfAGhkAhMPFgIfAGhkAhUPFgIfAGhkAhcPFgIfAGgWAgIBD2QWBgIBDxBkEBUBABUBABQrAwFnFgFmZAIDDxBkEBUBABUBABQrAwFnFgFmZAIFDxBkEBUBABUBABQrAwFnFgFmZAIZDxYCHwBoZAIbDxYCHwBoZAIdDxYCHwBoZAIfDxYCHwBoZAIhDxYCHwBoZAIjDxYCHwBoZAIlDxYCHwBoZAInDxYCHwBoFgICAQ9kFgICAQ8QDxYGHg1EYXRhVGV4dEZpZWxkBQZxa05hbWUeDkRhdGFWYWx1ZUZpZWxkBQNtSUQeC18hRGF0YUJvdW5kZ2QQFQENLS3or7fpgInmi6ktLRUBDS0t6K+36YCJ5oupLS0UKwMBZxYBZmQCKQ8WAh8AaGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFC0ltZ0J0bl9zYXZllkKY31LenRzYsFICRB7yeJcASnLmHGjkY/xchQeyZmM=" />


<script src="../ScriptResource-d=R1xvDyMEPGXVNGP0FCgj4H00XciIpgBWdmnhOgsm1-2fLvsTmocOafNMxqo62UOProS_mi9h21m7U-fuoHyf3EX1mslI7GefGftwP4GSy-01&t=16ab2387.axd" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
if (typeof(Sys) === 'undefined') throw new Error('ASP.NET Ajax 客户端框架未能加载。');
//]]>
</script>

<script src="register-_TSM_HiddenField_=ScriptManager1_HiddenField&_TSM_CombinedScripts_=__AjaxControlToolkit,+Version=3.0.20229.26313,+Culture=neutral,+PublicKeyToken=28f01b0e84b6d53e_zh-CN_0144264c-c32a-44fc-8b8c-9b13f87471bb_865923e8_91bd373d_e781f3bd_8e72a662.aspx" type="text/javascript"></script>
    
    <div id="UpdatePanel1">
	
    <div style="width:700px; margin-left:auto; margin-right:auto">
    <div id="Panel1">
		
 <div id="table" style="width:100%; font-size:13px">
           <table style="text-align:left">
        <tr>
        <td class="style1">账 号：</td>
        <td class="style2">
            <input name="txt_memberID" type="text" id="txt_memberID" onblur="checkUserExists(this.value)" />
            </td>
        <td style="width:300px">
            <div id="txt_memberIDTip" class="divClass"></div>
        </td>
        </tr>
        <tr>
        <td class="style1">密 码：</td>
        <td class="style2">
            <input name="txt_mPassword" type="password" maxlength="15" id="txt_mPassword" />
                
        
            </td>
        <td> <div id="txt_mPasswordTip" class="divClass"></div>
        </td>
        </tr>
        <tr>
        <td class="style1">密码确认：</td>
        <td class="style2">
            <input name="txt_mPwdConfirm" type="password" id="txt_mPwdConfirm" />
            </td>
        <td> <div id="txt_mPwdConfirmTip" class="divClass"></div></td>
        </tr>
        
                
                
                
                
                
                
                
         
                
                
        
        
        
        
               
                 
               <tr>
                   <td class="style1">
                   </td>
                   <td class="style2" style="text-align:center">
                       <input type="image" name="ImgBtn_save" id="ImgBtn_save" src="../template_files/images/btn_register.png" border="0" />
                   </td>
                   <td>
                   </td>
               </tr>
        </table>
        </div>
    
	</div>
    </div>
      
    
</div>
    

<script type="text/javascript">
//<![CDATA[
Sys.Application.add_init(function() {
    $create(AjaxControlToolkit.PasswordStrengthExtenderBehavior, {"BarBorderCssClass":"barBorder","DisplayPosition":5,"MinimumNumericCharacters":2,"PreferredPasswordLength":9,"RequiresUpperAndLowerCaseCharacters":true,"StrengthIndicatorType":1,"StrengthStyles":"barIndicator_weak;barIndicator_average;barIndicator_good","TextStrengthDescriptionStyles":"barIndicator_weak;barIndicator_average;barIndicator_good","id":"psBar"}, null, null, $get("txt_mPassword"));
});
Sys.Application.add_init(function() {
    $create(AjaxControlToolkit.RoundedCornersBehavior, {"BorderColor":"#8DB7E1","Radius":20,"id":"RoundedCornersExtender1"}, null, null, $get("Panel1"));
});
//]]>
</script>
</form>
</body>
</html>
